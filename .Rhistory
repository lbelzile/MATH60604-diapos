dfnew$average <- predict(lm(lcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
stat_summary(fun.y="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = aver, color = obésité, x = fumeur),  shape = 18, size= 3, data = addi2,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
stat_summary(fun.y="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = aver, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = aver, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom")
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
insurancefr <- insurance
insurancefr$lcharges <- log(insurancefr$charges)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obésité) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
insurancefr <- insurance
insurancefr$lcharges <- log(insurancefr$charges)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(lcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
insurancefr$lcharges <- resid(lm(log(charges) ~ age, data = insurancefr))
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
lm(log(charges) ~ age, data = insurancefr)
sigma(summary(lm(log(charges) ~ age, data = insurancefr)))
summary(lm(log(charges) ~ age, data = insurancefr))$sigma
-summary(lm(log(charges) ~ age, data = insurancefr))$sigma^2/2
insurancefr$lcharges <- exp(resid(lm(log(charges) ~ age, data = insurancefr))-summary(lm(log(charges) ~ age, data = insurancefr))$sigma^2/2)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
insurancefr <- insurance
insurancefr$lcharges <- exp(resid(lm(log(charges) ~ age, data = insurancefr))-summary(lm(log(charges) ~ age, data = insurancefr))$sigma^2/2)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(lcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
insurancefr$lcharges
mod1 <- lm(log(charges) ~ age, data = insurancefr)
insurancefr$lcharges <- exp(resid(mod1) + coef(mod1)[1]-summary(mod1)$sigma^2/2)
insurancefr$lcharges
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
insurancefr <- insurance
mod1 <- lm(log(charges) ~ age, data = insurancefr)
insurancefr$lcharges <- exp(resid(mod1) + coef(mod1)[1]-summary(mod1)$sigma^2/2)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(lcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = lcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = charges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
mod1 <- lm(charges ~ age, data = insurancefr)
insurancefr$rcharges <- resid(mod1) + coef(mod1)[1]
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
insurancefr <- insurance
mod1 <- lm(charges ~ age, data = insurancefr)
insurancefr$rcharges <- resid(mod1) + coef(mod1)[1]
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(rcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = rcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
coef(mod1)[1]
resid(mod1)
insurancefr <- insurance
mod1 <- lm(charges ~ age, data = insurancefr)
insurancefr$rcharges <- resid(mod1) + coef(mod1)[1]
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(rcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
dfnew$average <- predict(lm(rcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = rcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
mod1 <- lm(log(charges) ~ age, data = insurancefr)
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
insurancefr$rcharges
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
insurancefr <- insurance
mod1 <- lm(log(charges) ~ age, data = insurancefr)
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(rcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = rcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (ln, en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
insurance <- read.csv("https://lbelzile.bitbucket.io/MATH60619A/insurance.csv",
header = TRUE,
stringsAsFactors = TRUE)
insurance$smoker <- factor(insurance$smoker, labels = c("non-smoker", "smoker"))
insurance$obese2 <- factor(I(insurance$bmi >= 30), labels = c("non-obese","obese"))
insurance$obesity <- factor(I(insurance$bmi >= 30) + I(insurance$bmi >= 25), labels = c("low and normal","overweight","obese"))
mod1 <- lm(log(charges) ~ age, data = insurance)
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
# betas  <- coef(lm(log(charges) ~ smoker + obese + obese2, data = insurance))
# addi <- data.frame(aver = c(betas[1], sum(betas[1:2]),  sum(betas[c(1,3)]), sum(betas)),
#                    smoker = factor(c(0,1,0,1), labels = levels(insurance$smoker)),
#                    obese = factor(c(0,0,1,1), labels = levels(insurance$obese2)))
mod2  <- lm(rcharges ~ smoker + obesity, data = insurance)
# print(ggplot(aes(y = lcharges, x = smoker, color = obese), data = insurance) +
#          geom_boxplot(outlier.shape = NA) +
#          scale_color_manual(values=c(heccyan, hecblue)) +
#          ylab("charges (log, in USD)") +
#          theme_minimal() +
#          geom_point(aes(y = aver, color = obese, x = smoker),  shape = 18, size= 3, data = addi,  position = position_dodge(0.75)) #+
#          # stat_summary(fun.y=mean, geom="point", shape=23, size=4)
#          # http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
# )
dfnew <- expand.grid(unique(insurance$obesity), unique(insurance$smoker))
colnames(dfnew) <- c("obesity", "smoker")
dfnew$average <- predict(lm(rcharges ~ smoker + obesity, data = insurance), newdata = dfnew)
insurance <- read.csv("https://lbelzile.bitbucket.io/MATH60619A/insurance.csv",
header = TRUE,
stringsAsFactors = TRUE)
insurance$smoker <- factor(insurance$smoker, labels = c("non-smoker", "smoker"))
insurance$obese2 <- factor(I(insurance$bmi >= 30), labels = c("non-obese","obese"))
insurance$obesity <- factor(I(insurance$bmi >= 30) + I(insurance$bmi >= 25), labels = c("low and normal","overweight","obese"))
mod1 <- lm(log(charges) ~ age, data = insurance)
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
mod2  <- lm(rcharges ~ smoker + obesity, data = insurance)
insurance$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
mod2  <- lm(rcharges ~ smoker + obesity, data = insurance)
dfnew <- expand.grid(unique(insurance$obesity), unique(insurance$smoker))
colnames(dfnew) <- c("obesity", "smoker")
dfnew$average <- predict(lm(rcharges ~ smoker + obesity, data = insurance), newdata = dfnew)
print(ggplot(aes(y = lcharges, x = smoker, color = obesity), data = insurance) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey", hecblue)) +
ylab("charges (ln, in USD) | age") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obesity, x = smoker),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
print(ggplot(aes(y = rcharges, x = smoker, color = obesity), data = insurance) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey", hecblue)) +
ylab("charges (ln, in USD) | age") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obesity, x = smoker),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
pdf("03-linreg-interaction_categ.pdf", width=6, height=3)
print(ggplot(aes(y = rcharges, x = smoker, color = obesity), data = insurance) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey", hecblue)) +
ylab("charges (in USD) | age") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obesity, x = smoker),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
dev.off()
pdf("03-linreg-interaction_categ_fr.pdf", width=6, height=3)
insurancefr <- insurance
mod1 <- lm(log(charges) ~ age, data = insurancefr)
insurancefr$rcharges <- exp(resid(mod1) + coef(mod1)[1] - summary(mod1)$sigma^2/2)
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(rcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = rcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
dev.off()
insurance <- read.csv("https://lbelzile.bitbucket.io/MATH60619A/insurance.csv",
header = TRUE,
stringsAsFactors = TRUE)
insurance$smoker <- factor(insurance$smoker, labels = c("non-smoker", "smoker"))
insurance$obese2 <- factor(I(insurance$bmi >= 30), labels = c("non-obese","obese"))
insurance$obesity <- factor(I(insurance$bmi >= 30) + I(insurance$bmi >= 25), labels = c("low and normal","overweight","obese"))
mod1 <- lm(charges ~ age, data = insurance)
insurance$rcharges <- resid(mod1) + coef(mod1)[1]
dfnew <- expand.grid(unique(insurance$obesity), unique(insurance$smoker))
colnames(dfnew) <- c("obesity", "smoker")
dfnew$average <- predict(lm(rcharges ~ smoker + obesity, data = insurance), newdata = dfnew)
pdf("03-linreg-interaction_categ.pdf", width=6, height=3)
print(ggplot(aes(y = rcharges, x = smoker, color = obesity), data = insurance) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey", hecblue)) +
ylab("charges (in USD) | age") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obesity, x = smoker),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
dev.off()
pdf("03-linreg-interaction_categ_fr.pdf", width=6, height=3)
insurancefr <- insurance
mod1 <- lm(charges ~ age, data = insurancefr)
insurancefr$rcharges <- resid(mod1) + coef(mod1)[1]
colnames(insurancefr)[5] <- colnames(addi2)[2] <- "fumeur"
levels(insurancefr$fumeur) <- levels(addi2$fumeur) <- c("non-fumeur","fumeur")
levels(insurancefr$obesity) <- levels(addi2[,3]) <- c("insuffisance, normal", "surpoids","obèse")
colnames(insurancefr)[9] <- colnames(addi2)[3]<- "obésité"
dfnew <- expand.grid(unique(insurancefr$obésité), unique(insurancefr$fumeur))
colnames(dfnew) <- c("obésité", "fumeur")
dfnew$average <- predict(lm(rcharges ~ fumeur + obésité, data = insurancefr), newdata = dfnew)
print(ggplot(aes(y = rcharges, x = fumeur, color = obésité), data = insurancefr) +
geom_boxplot(outlier.shape = NA) +
scale_color_manual(values=c(heccyan, "grey",hecblue)) +
ylab("frais (en dollars américains) | âge") +
theme_minimal() +
theme(legend.position = "bottom") +
stat_summary(fun ="mean", geom="point", position = position_dodge(0.75)) +
geom_point(aes(y = average, color = obésité, x = fumeur),  shape = 18, size= 3, data = dfnew,  position = position_dodge(0.75)) #+
# stat_summary(fun.y=mean, geom="point", shape=23, size=4)
# http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization
)
dev.off()
index <- c("0_","1a","1b","1c","2a","2b","2c","2d","3_")
index0 <- c("0","1a","1b","1c","2a","2b","2c","2d","3")
names <- c("Course Outline",
"Hypothesis Tests",
"Central Limit Theorem",
"Exploratory Data Analysis",
"Parameter interpretation (linear model)",
"Linear transformations",
"Geometry of least squares",
"Hypothesis tests (linear model)",
"Maximum likelihood estimation")
ns <- length(index)
url <- "https://lbelzile.github.io/MATH60604A-slides/"
codedir <- "../code"
setwd("~/Documents/Dropbox/website/statmod/vignettes")
slides <- list.files(path = "/home/lbelzile/Documents/Dropbox/website/MATH60604A-slides", pattern = "*.html")
slides <- slides[substr(slides, 1, 12) == "MATH60604A_w"]
sl <- rep("", ns)
pmasl <- na.omit(pmatch(index, substr(slides, start = 13, stop = 14)))
sl[pmasl] <- paste0("[html](",url, slides,")")
slidespdf <- list.files(path = "/home/lbelzile/Documents/Dropbox/website/MATH60604A-slides", pattern = ".*.pdf")
slidespdf <- slidespdf[substr(slidespdf, 1, 12) == "MATH60604A_w"]
slpdf <- rep("", ns)
pmaslp <- na.omit(pmatch(index, substr(slidespdf, start = 13, stop = 14)))
slpdf[pmaslp] <- paste0("[pdf](",url, slidespdf,")")
index <- c("0_","1a","1b","1c","2a","2b","2c","2d","3_")
index0 <- c("0","1a","1b","1c","2a","2b","2c","2d","3")
names <- c("Course Outline",
"Hypothesis Tests",
"Central Limit Theorem",
"Exploratory Data Analysis",
"Parameter interpretation (linear model)",
"Linear transformations",
"Geometry of least squares",
"Hypothesis tests (linear model)",
"Maximum likelihood estimation")
ns <- length(index)
url <- "https://lbelzile.github.io/MATH60604A-slides/"
codedir <- "../code"
slides <- list.files(path = "/home/lbelzile/Documents/Dropbox/website/MATH60604A-slides", pattern = "MATH60604A_w*.html")
slides <- slides[substr(slides, 1, 12) == "MATH60604A_w"]
sl <- rep("", ns)
pmasl <- na.omit(pmatch(index, substr(slides, start = 13, stop = 14)))
sl[pmasl] <- paste0("[html](",url, slides,")")
slidespdf <- list.files(path = "/home/lbelzile/Documents/Dropbox/website/MATH60604A-slides", pattern = "MATH60604A_w.*.pdf")
slidespdf <- slidespdf[substr(slidespdf, 1, 12) == "MATH60604A_w"]
slpdf <- rep("", ns)
pmaslp <- na.omit(pmatch(index, substr(slidespdf, start = 13, stop = 14)))
slpdf[pmaslp] <- paste0("[pdf](",url, slidespdf,")")
slidespdf
index <- c("0_","1a","1b","1c","2a","2b","2c","2d","2e","2f","2g","3_")
index0 <- c("0","1a","1b","1c","2a","2b","2c","2d","2e","2f","2g","3")
names <- c("Course Outline",
"Hypothesis Tests",
"Central Limit Theorem",
"Exploratory Data Analysis",
"Parameter interpretation (linear model)",
"Linear transformations",
"Geometry of least squares",
"Hypothesis tests (linear model)",
"Coefficient of determination",
"Predictions",
"Interactions",
"Maximum likelihood estimation"
)
ns <- length(index)
url <- "https://lbelzile.github.io/MATH60604A-slides/"
codedir <- "../code"
slides <- list.files(path = "/home/lbelzile/Documents/Dropbox/website/MATH60604A-slides", pattern = "MATH60604A_w*.html")
slides <- slides[substr(slides, 1, 12) == "MATH60604A_w"]
sl <- rep("", ns)
pmasl <- na.omit(pmatch(index, substr(slides, start = 13, stop = 14)))
sl[pmasl] <- paste0("[html](",url, slides,")")
slidespdf <- list.files(path = "/home/lbelzile/Documents/Dropbox/website/MATH60604A-slides", pattern = "MATH60604A_w.*.pdf")
slidespdf <- slidespdf[substr(slidespdf, 1, 12) == "MATH60604A_w"]
slpdf <- rep("", ns)
pmaslp <- na.omit(pmatch(index, substr(slidespdf, start = 13, stop = 14)))
slpdf[pmaslp] <- paste0("[pdf](",url, slidespdf,")")
video <- c("https://youtu.be/luOkCcpDSjs",
"https://youtu.be/TSMuEX8FqYo",
"https://youtu.be/nCUT05szKwQ",
"https://youtu.be/5Yc46pAQpFk",
"https://youtu.be/4jOnZrnPlUM",
"https://youtu.be/MzmS9r-77lI",
"https://youtu.be/F9dR6mpOVtI",
"https://youtu.be/PatlZ9mlVuk",
"https://youtu.be/IO3et3Uk4mQ"
)
if(length(names) - length(video) > 0){
video <- c(video, rep("", length(names) - length(video)))
}
linkgithub <- "https://raw.githubusercontent.com/lbelzile/statmod/master/"
codesas <- list.files(path = codedir, pattern = "MATH60604A.*.sas")
codestr <- rep("", ns)
nid <- sapply(substr(codesas,12,13), function(x){which(x == index)})
codestr[nid] <- paste0("[SAS](",linkgithub, "code/", codesas,")")
codeR <- list.files(path = codedir, pattern = "MATH60604.*.R")
codeRstr <- rep("", ns)
nid <- sapply(substr(codeR,12,13), function(x){pmatch(x, index)})
codeRstr[nid] <- paste0("[R](",linkgithub,"code/", codeR,")")
sldat <- data.frame('S' = index0,
Content = names,
Slides = sl,
PDF = slpdf,
Videos =  paste0("[videos](", video, ")"),
SAS = codestr,
R = codeRstr)
sldat
setwd("..")
pkgdown::build_site()
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
files <- list.files(pattern = "^MATH60604.*\\.Rmd$", full.names = TRUE)
for(file in files){
pagedown::chrome_print(file)
}
files
file
pagedown::chrome_print(file)
pagedown::chrome_print(file)
pagedown::chrome_print(file)
pagedown::chrome_print(file)
